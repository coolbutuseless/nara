
# copy_into
# duplicate 
# fill
# flipv
# fliph
# replace

test_that("nr-core works", {
  
  nr <- nr_new(4, 3, 'white')
  nr_point(nr, 0, 0, color = 'black')
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Duplicate
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  nr2 <- nr_duplicate(nr)
  expect_equal(nr, nr2)

  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Copy Into
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  nr3 <- nr_new(4, 3, 0L)
  nr_copy_into(nr3, nr)  
  expect_equal(nr, nr3)
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Fill
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  nr <- nr_new(4, 3, 'white')
  nr2 <- nr_new(4, 3, 'black')
  nr_fill(nr, 'black')
  expect_equal(nr, nr2)
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Replace
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  
  nr <- nr_new(4, 3, 'white')
  nr2 <- nr_new(4, 3, 'black')
  nr_replace(nr, 'white', 'black')
  expect_equal(nr, nr2)
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # FlipV
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  nr  <- nr_new(4, 3, 'white')
  nr2 <- nr_new(4, 3, 'white')
  nr_point(nr , 0, 0, color = 'black')
  nr_point(nr2, 0, 2, color = 'black')
  nr_flipv(nr)
  expect_equal(nr, nr2)
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # FlipH
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  
  nr  <- nr_new(4, 3, 'white')
  nr2 <- nr_new(4, 3, 'white')
  nr_point(nr , 0, 0, color = 'black')
  nr_point(nr2, 3, 0, color = 'black')
  nr_fliph(nr)
  expect_equal(nr, nr2)
})
